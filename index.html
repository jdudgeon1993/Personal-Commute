<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Commute Dashboard ‚Äì Drive & N Line</title>

<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

<style>
    :root {
        --bg: #f4f6f9;
        --card: #ffffff;
        --text: #222;
        --accent: #4a6cff;
        --shadow: rgba(0,0,0,0.15);
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --bg: #1c1f26;
            --card: #262a33;
            --text: #e6e6e6;
            --accent: #7a90ff;
            --shadow: rgba(0,0,0,0.4);
        }
    }

    body {
        font-family: Inter, sans-serif;
        margin: 0;
        padding: 0;
        background: var(--bg);
        color: var(--text);
        display: flex;
        justify-content: center;
        padding: 20px;
    }

    .app {
        width: 100%;
        max-width: 520px;
    }

    h1 {
        text-align: center;
        font-size: 1.9rem;
        margin-top: 0;
        font-weight: 800;
        letter-spacing: -1px;
    }

    .card {
        background: var(--card);
        padding: 20px;
        border-radius: 22px;
        box-shadow: 0 10px 25px var(--shadow);
        margin-bottom: 25px;
        animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    label {
        font-weight: 600;
        font-size: 0.95rem;
        margin-top: 12px;
        display: block;
    }

    input {
        width: 100%;
        padding: 10px 12px;
        margin-top: 6px;
        border-radius: 12px;
        border: 1px solid #ccc;
        font-size: 1rem;
        background: var(--bg);
        color: var(--text);
    }

    .tabs {
        display: flex;
        margin-bottom: 15px;
        gap: 10px;
    }

    .tab {
        flex: 1;
        padding: 12px;
        font-weight: 600;
        border-radius: 14px;
        background: var(--card);
        text-align: center;
        cursor: pointer;
        box-shadow: 0 3px 10px var(--shadow);
        transition: 0.15s;
    }

    .tab:hover {
        transform: scale(1.02);
    }

    .tab.active {
        background: var(--accent);
        color: white;
    }

    .result-box {
        padding: 15px;
        margin-top: 20px;
        border-radius: 14px;
        font-size: 1.1rem;
        text-align: center;
        background: var(--bg);
    }

    .button {
        width: 100%;
        margin-top: 18px;
        padding: 14px;
        font-size: 1.1rem;
        font-weight: 700;
        border: none;
        border-radius: 14px;
        background: var(--accent);
        color: #fff;
        cursor: pointer;
    }

    .button i {
        margin-right: 8px;
    }
</style>
</head>

<body>
<div class="app">
    <h1>üöá Commute Dashboard</h1>

    <div class="tabs">
        <div class="tab active" id="driveTab">üöó Drive</div>
        <div class="tab" id="transitTab">üöÜ N Line</div>
    </div>

    <div class="card">
        <label>From:</label>
        <input id="from" placeholder="123 Main St, SF">

        <label>To:</label>
        <input id="to" placeholder="Work address">

        <button class="button" onclick="calculateTime()">
            <i class="fa-solid fa-arrows-rotate"></i> Refresh
        </button>

        <div id="result" class="result-box">Enter a location to begin.</div>
    </div>
</div>

<script>
// YOUR API KEY:
const API_KEY = "AIzaSyD37ON3q4SfgV7jHWdE74PtwoRdP_5gCGY";

let mode = "drive";

// Tab switching
document.getElementById("driveTab").onclick = () => {
    mode = "drive";
    setActiveTab();
};
document.getElementById("transitTab").onclick = () => {
    mode = "transit";
    setActiveTab();
};

function setActiveTab() {
    document.getElementById("driveTab").classList.remove("active");
    document.getElementById("transitTab").classList.remove("active");

    if (mode === "drive") document.getElementById("driveTab").classList.add("active");
    else document.getElementById("transitTab").classList.add("active");
}

async function calculateTime() {
    const from = document.getElementById("from").value.trim();
    const to = document.getElementById("to").value.trim();
    const resultBox = document.getElementById("result");

    if (!from || !to) {
        resultBox.textContent = "Please enter both locations.";
        return;
    }

    resultBox.textContent = "Loading‚Ä¶";

    let url = "";

    if (mode === "drive") {
        url =
            `https://maps.googleapis.com/maps/api/distancematrix/json?origins=${encodeURIComponent(from)}&destinations=${encodeURIComponent(to)}&mode=driving&departure_time=now&key=${API_KEY}`;
    } else {
        url =
            `https://maps.googleapis.com/maps/api/directions/json?origin=${encodeURIComponent(from)}&destination=${encodeURIComponent(to)}&mode=transit&transit_mode=train&departure_time=now&key=${API_KEY}`;
    }

    try {
        const response = await fetch(url);
        const data = await response.json();

        if (mode === "drive") {
            const info = data.rows?.[0]?.elements?.[0];
            if (info?.duration_in_traffic) {
                resultBox.textContent = `üöó Drive Time: ${info.duration_in_traffic.text}`;
            } else {
                resultBox.textContent = "Unable to fetch driving time.";
            }
        } else {
            // Transit - filter for N Judah train
            const route = data.routes?.[0];
            if (!route) {
                resultBox.textContent = "No transit route found.";
                return;
            }

            const legs = route.legs[0];
            const steps = legs.steps;

            const nLineStep = steps.find(
                s =>
                    s.transit_details &&
                    (s.transit_details.line.short_name === "N" ||
                     s.transit_details.line.name.includes("N"))
            );

            if (!nLineStep) {
                resultBox.textContent = "‚ö†Ô∏è No N Line (N Judah) trains available right now.";
                return;
            }

            resultBox.textContent = `üöÜ N Line Time: ${legs.duration.text}`;
        }
    } catch (err) {
        resultBox.textContent = "Error retrieving commute data.";
    }
}
</script>

</body>
</html>